/* Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and
 * MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses.
 */(function($){function callbackIfComplete(a){a.debug&&(debug('callbackIfComplete()'),debug('totalFiles: '+a.totalFiles),debug('filesLoaded: '+a.filesLoaded)),a.async&&a.filesLoaded===a.totalFiles&&a.callback&&a.callback()}function loadAndParseFiles(a,b){b.debug&&debug('loadAndParseFiles'),null!==a&&0<a.length?loadAndParseFile(a[0],b,function(){a.shift(),loadAndParseFiles(a,b)}):callbackIfComplete(b)}function loadAndParseFile(a,b,c){b.debug&&(debug('loadAndParseFile(\''+a+'\')'),debug('totalFiles: '+b.totalFiles),debug('filesLoaded: '+b.filesLoaded)),null!==a&&'undefined'!=typeof a&&$.ajax({url:a,async:b.async,cache:b.cache,dataType:'text',success:function(d){b.debug&&(debug('Succeeded in downloading '+a+'.'),debug(d)),parseData(d,b),c()},error:function(d,e,f){b.debug&&debug('Failed to download or parse '+a+'. errorThrown: '+f),404===d.status&&(b.totalFiles-=1),c()}})}function parseData(data,settings){for(var line,parsed='',lines=data.split(/\n/),regPlaceHolder=/(\{\d+})/g,regRepPlaceHolder=/\{(\d+)}/g,unicodeRE=/(\\u.{4})/ig,i=0,j=lines.length;i<j;i++)if(line=lines[i],line=line.trim(),0<line.length&&'#'!=line.match('^#')){var pair=line.split('=');if(0<pair.length){for(var name=decodeURI(pair[0]).trim(),value=1==pair.length?'':pair[1];-1!=value.search(/\\$/);)value=value.substring(0,value.length-1),value+=lines[++i].trimRight();for(var s=2;s<pair.length;s++)value+='='+pair[s];if(value=value.trim(),'map'==settings.mode||'both'==settings.mode){var unicodeMatches=value.match(unicodeRE);unicodeMatches&&unicodeMatches.forEach(function(a){value=value.replace(a,unescapeUnicode(a))}),settings.namespace?$.i18n.map[settings.namespace][name]=value:$.i18n.map[name]=value}if('vars'==settings.mode||'both'==settings.mode)if(value=value.replace(/"/g,'\\"'),checkKeyNamespace(name),regPlaceHolder.test(value)){var parts=value.split(regPlaceHolder),first=!0,fnArgs='',usedArgs=[];parts.forEach(function(a){regPlaceHolder.test(a)&&(0===usedArgs.length||-1==usedArgs.indexOf(a))&&(!first&&(fnArgs+=','),fnArgs+=a.replace(regRepPlaceHolder,'v$1'),usedArgs.push(a),first=!1)}),parsed+=name+'=function('+fnArgs+'){';var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+='return '+fnExpr+';};'}else parsed+=name+'="'+value+'";'}}eval(parsed),settings.filesLoaded+=1}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key))for(var name,fullname='',names=key.split(/\./),i=0,j=names.length;i<j;i++)name=names[i],0<i&&(fullname+='.'),fullname+=name,eval('typeof '+fullname+' == "undefined"')&&eval(fullname+'={};')}function unescapeUnicode(a){var b=[],c=parseInt(a.substr(2),16);return 0<=c&&c<Math.pow(2,16)&&b.push(c),b.reduce(function(d,e){return d+String.fromCharCode(e)},'')}$.i18n={},$.i18n.map={};var debug=function(a){window.console&&console.log('i18n::'+a)};$.i18n.properties=function(a){a=$.extend({name:'Messages',language:'',path:'',namespace:null,mode:'vars',cache:!1,debug:!1,encoding:'UTF-8',async:!1,callback:null},a),a.namespace&&'string'==typeof a.namespace&&(a.namespace.match(/^[a-z]*$/)?$.i18n.map[a.namespace]={}:(debug('Namespaces can only be lower case letters, a - z'),a.namespace=null)),a.path.match(/\/$/)||(a.path+='/'),a.language=this.normaliseLanguageCode(a);var c=a.name&&a.name.constructor===Array?a.name:[a.name];a.totalFiles=2*c.length+(5<=a.language.length?c.length:0),a.debug&&debug('totalFiles: '+a.totalFiles),a.filesLoaded=0,c.forEach(function(d){var e,f,g,h;e=a.path+d+'.properties';var k=a.language.substring(0,2);if(f=a.path+d+'_'+k+'.properties',5<=a.language.length){var l=a.language.substring(0,5);g=a.path+d+'_'+l+'.properties',h=[e,f,g]}else h=[e,f];loadAndParseFiles(h,a)}),a.callback&&!a.async&&a.callback()},$.i18n.prop=function(a){var b=[].slice.call(arguments),c,d;if(2==b.length)if($.isArray(b[1]))c=b[1];else if('object'==typeof b[1]){d=b[1].namespace;var e=b[1].replacements;b.splice(-1,1),e&&Array.prototype.push.apply(b,e)}var f=d?$.i18n.map[d][a]:$.i18n.map[a];if(null===f)return'['+(d?d+'#'+a:a)+']';var g;if('string'==typeof f){for(g=0;-1!=(g=f.indexOf('\\',g));)f='t'==f.charAt(g+1)?f.substring(0,g)+'\t'+f.substring(g++ +2):'r'==f.charAt(g+1)?f.substring(0,g)+'\r'+f.substring(g++ +2):'n'==f.charAt(g+1)?f.substring(0,g)+'\n'+f.substring(g++ +2):'f'==f.charAt(g+1)?f.substring(0,g)+'\f'+f.substring(g++ +2):'\\'==f.charAt(g+1)?f.substring(0,g)+'\\'+f.substring(g++ +2):f.substring(0,g)+f.substring(g+1);var k,l,h=[];for(g=0;g<f.length;)if('\''==f.charAt(g)){if(g==f.length-1)f=f.substring(0,g);else if('\''==f.charAt(g+1))f=f.substring(0,g)+f.substring(++g);else{for(k=g+2;-1!=(k=f.indexOf('\'',k));)if(k==f.length-1||'\''!=f.charAt(k+1)){f=f.substring(0,g)+f.substring(g+1,k)+f.substring(k+1),g=k-1;break}else f=f.substring(0,k)+f.substring(++k);-1==k&&(f=f.substring(0,g)+f.substring(g+1))}}else if('{'!=f.charAt(g))g++;else if(k=f.indexOf('}',g+1),-1==k)g++;else if(l=parseInt(f.substring(g+1,k)),!isNaN(l)&&0<=l){var m=f.substring(0,g);''!==m&&h.push(m),h.push(l),g=0,f=f.substring(k+1)}else g=k+1;''!==f&&h.push(f),f=h,d?$.i18n.map[settings.namespace][a]=h:$.i18n.map[a]=h}if(!!f){if(0===f.length)return'';if(1==f.length&&'string'==typeof f[0])return f[0];var n='';for(g=0,k=f.length;g<k;g++)n+='string'==typeof f[g]?f[g]:c&&f[g]<c.length?c[f[g]]:!c&&f[g]+1<b.length?b[f[g]+1]:'{'+f[g]+'}'}return n},$.i18n.normaliseLanguageCode=function(a){var b=a.language;return(!b||2>b.length)&&(a.debug&&debug('No language supplied. Pulling it from the browser ...'),b=navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage||'en',a.debug&&debug('Language from browser: '+b)),b=b.toLowerCase(),b=b.replace(/-/,'_'),3<b.length&&(b=b.substring(0,3)+b.substring(3).toUpperCase()),b}})(jQuery);